"0","  "
"0","  ##Fourth Model (regularized movie & user biases)"
"0","  #RMSE = 0.8564223 (This is the final RMSE)"
"0","  #Some movies are rated by very few users, this can increase RMSE"
"0","  #Regularisation allows for reduced errors caused by movies "
"0","  #with few ratings which can influence the prediction  and skew the error"
"0","  "
"0","  lambdas <- seq(from=0, to=10, by=0.25)"
"0","  rmses <- sapply(lambdas, function(x){"
"0","    movie_bias <- training_dataset %>%"
"0","      group_by(movieId) %>%"
"0","      summarize(movie_bias = sum(rating - mean_movie_rating)/(n()+x))"
"0","    user_bias <- training_dataset %>%"
"0","      left_join(movie_bias, by = ""movieId"") %>%"
"0","      group_by(userId) %>%"
"0","      summarize(user_bias = sum(rating - movie_bias - mean_movie_rating)/(n()+x))"
"0","    predictions <- test_dataset %>%"
"0","      left_join(movie_bias, by = ""movieId"") %>%"
"0","      left_join(user_bias, by = ""userId"") %>%"
"0","      mutate(new_pred = mean_movie_rating + movie_bias + user_bias) %>%"
"0","      pull(new_pred)"
"0","    return(rmse(predictions, test_dataset$rating))"
"0","  })"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"0","  #We plot RMSE against lambdas to obtain optimal lambda"
"0","  #lambda at 5 produces the lowest RMSE"
"0","  qplot(lambdas, rmses, color = I(""brown"")) "
